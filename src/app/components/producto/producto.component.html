<div fxLayout="column" class="sic-com-producto">
  <div class="sic-com-spinner-container" fxLayoutAlign="center center" *ngIf="loadingProducto">
    <mat-spinner [diameter]="50" [strokeWidth]="6"></mat-spinner>
  </div>
  <div *ngIf="!loadingProducto">
    <div fxLayoutAlign="start center" class="sic-com-ir-listado" (click)="irAlListado()">
      <mat-icon>keyboard_arrow_left</mat-icon>
      <strong>Ir al listado</strong>
    </div>
    <div fxLayout="column" fxLayoutAlign="start center">
      <img class="sic-com-img-producto" [src]="producto.urlImagen" (click)="toggleImgViewer()">
      <button mat-icon-button color="primary" (click)="toggleImgViewer()">
        <mat-icon aria-label="Pantalla completa">zoom_in</mat-icon>
      </button>
      <div class="img-viewer" *ngIf="imgViewerVisible">
        <div fxLayout="column" fxLayoutAlign="center center" fxFill>
          <img [src]="producto.urlImagen" (click)="toggleImgViewer()">
          <button mat-button color="primary" (click)="toggleImgViewer()">
            <mat-icon aria-label="Cerrar imagen">close</mat-icon> CERRAR
          </button>
        </div>
      </div>
      <div class="sic-com-detalle-producto">
        <div fxLayout="column">
          <span class="sic-com-codigo-producto">{{producto.codigo}}</span>
          <span class="sic-com-descripcion-producto">{{producto.descripcion}}</span>
          <br>
          <div fxLayout="row" fxLayoutAlign="left center" fxLayoutGap=".5rem">
            <span class="sic-com-precio-producto" [class.bonificado]="esProductoBonificado()">
            $ {{producto.precioLista | number:'1.2-2':'es-AR'}}
            </span>
            <span class="sic-com-precio-bonificado" *ngIf="esProductoBonificado()">
              $ {{producto.precioBonificado | number:'1.2-2':'es-AR'}}
            </span>
          </div>
          <span class="bonificado-label" *ngIf="cliente && esProductoBonificado()">
            {{ cliente.bonificacion | number:'1.0-2':'es-AR' }}% bonificado!
          </span>
          <br>
          <mat-chip-list>
            <mat-chip class="sic-com-stock" [style.background-color]="(producto.hayStock ? 'limegreen' : 'red')">
              {{producto.hayStock ? "Hay Stock" : "Sin Stock"}}
            </mat-chip>
          </mat-chip-list>
        </div>
        <div fxLayoutAlign="center center" class="sic-com-controles-cantidad" *ngIf="authService.isAuthenticated()">
          <button mat-mini-fab color="accent" (click)="cambiarCantidad(cantidad, 0)" [disabled]="cargandoAlCarrito">
            <mat-icon>remove</mat-icon>
          </button>
          <mat-form-field class="sic-com-input-cantidad">
            <input matInput autofocus type="number" [(ngModel)]='cantidad' placeholder="Cantidad"
                   min="0" [disabled]="cargandoAlCarrito">
          </mat-form-field>
          <button mat-mini-fab color="primary" (click)="cambiarCantidad(cantidad, 1)" [disabled]="cargandoAlCarrito">
            <mat-icon>add</mat-icon>
          </button>
        </div>
        <div fxLayoutAlign="center center" *ngIf="authService.isAuthenticated()">
          <button mat-raised-button color="primary" class="sic-com-boton-agregar" (click)="cargarAlCarrito()"
                  [disabled]="cantidad <= 0" *ngIf="!cargandoAlCarrito">
            <mat-icon>add_shopping_cart</mat-icon> Agregar al Carrito
          </button>
          <mat-spinner [diameter]="50" [strokeWidth]="6" *ngIf="cargandoAlCarrito"></mat-spinner>
        </div>
        <div fxLayoutAlign="center center" class="sic-com-controles-cantidad" *ngIf="!authService.isAuthenticated()">
          <button mat-raised-button fxFill routerLink="/login" color="primary">
            <mat-icon>shopping_cart</mat-icon>
            Comprar
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
